# 白盒审计方法论（落地版）

## 目标
- 让审计从“找漏洞”变成“做决策”，保证可交付与可复核。
- 以证据链为核心，降低误报与漏报。

## 核心模型
- Source → Propagation → Sink
- 任何漏洞本质：不可信输入到达危险操作。

## 优先级公式
- 优先级 = (攻击面大小 × 潜在影响) / 利用复杂度
- 原则：优先审计认证链，认证绕过会放大所有风险。

## 五阶段流程（Phase 1~5）
1. Phase 1 信息收集与攻击面识别。输出：技术栈画像、模块地图、攻击面清单、安全机制。
2. Phase 2 并行模式匹配扫描。输出：高风险区域地图（不是最终漏洞清单）。
3. Phase 3 关键路径手工审计。输出：完整证据链与可控性结论。
4. Phase 4 漏洞验证与攻击链构建。输出：可利用性判断与组合风险评估。
5. Phase 5 报告输出。输出：报告与终止决策记录。

## Agent 并行切分原则
- 由攻击面推导，不套固定模板。
- 搜索模式互不重叠，避免重复扫描同一代码片段。
- 并行任务零依赖，可同时启动。

## 多轮审计与终止规则
- 多轮不是重复，而是覆盖面 → 深度 → 关联度。
- 终止前必须回答 Q1: 有没有计划搜索但没搜到的区域？
- 终止前必须回答 Q2: 发现的入口点是否都追踪到了 Sink？
- 终止前必须回答 Q3: 高风险发现之间是否可能存在跨模块关联？
- 任一为 YES → 继续下一轮。

## 严重等级模型
- 三维评估：可达性、影响范围、利用复杂度。
- 独立等级：假设不存在其他漏洞时的等级。
- 组合等级：考虑攻击链后对实际风险的等级。

## 重要原则
- 模型是工具，方法论是框架。
- 宁可多做一轮，也不要漏掉关键风险。

## 动态 Debug 判定规则（模块差异化）
- SQL / 命令 / 文件：重点看输入是否被限制（no_change → 成立）
- XSS / SSTI：重点看输出是否被编码/模板逃逸
- SSRF / XXE：重点看 URL 是否被限制或域名白名单
- CSRF / 鉴权：重点看 token / 权限校验是否生效
- 若仅有轻微变化（weak_change），标记为“条件成立”
