rules:
  - id: php-deserialize-taint
    languages: [php]
    message: "Tainted data passed to unserialize/deserialize"
    severity: ERROR
    mode: taint
    pattern-sources:
      - pattern: $_GET[$X]
      - pattern: $_POST[$X]
      - pattern: $_REQUEST[$X]
      - pattern: $_COOKIE[$X]
      - pattern: request()->input($X)
      - pattern: $REQ->input($X)
      - pattern: input($X)
    pattern-sanitizers:
      - pattern: preg_match(...)
      - pattern: hash_equals(...)
    pattern-sinks:
      - pattern: unserialize(...)
      - pattern: igbinary_unserialize(...)
      - pattern: yaml_parse(...)
